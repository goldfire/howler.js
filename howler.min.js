/*!
 *  howler.js v1.1.14
 *  howlerjs.com
 *
 *  (c) 2013, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
!function(){var e={},t=null,n=!0,i=!1;if("undefined"!=typeof AudioContext)t=new AudioContext;else if("undefined"!=typeof webkitAudioContext)t=new webkitAudioContext;else if("undefined"!=typeof Audio){n=!1;try{new Audio}catch(r){i=!0}}else n=!1,i=!0;if(n){var a="undefined"==typeof t.createGain?t.createGainNode():t.createGain();a.gain.value=1,a.connect(t.destination)}var o=function(){this._volume=1,this._muted=!1,this.usingWebAudio=n,this._howls=[]};o.prototype={volume:function(e){var t=this;if(e=parseFloat(e),e&&e>=0&&1>=e){t._volume=e,n&&(a.gain.value=e);for(var i in t._howls)if(t._howls.hasOwnProperty(i)&&t._howls[i]._webAudio===!1)for(var r=0;r<t._howls[i]._audioNode.length;r++)t._howls[i]._audioNode[r].volume=t._howls[i]._volume*t._volume;return t}return n?a.gain.value:t._volume},mute:function(){return this._setMuted(!0),this},unmute:function(){return this._setMuted(!1),this},_setMuted:function(e){var t=this;t._muted=e,n&&(a.gain.value=e?0:t._volume);for(var i in t._howls)if(t._howls.hasOwnProperty(i)&&t._howls[i]._webAudio===!1)for(var r=0;r<t._howls[i]._audioNode.length;r++)t._howls[i]._audioNode[r].muted=e}};var s=new o,l=null;if(!i){l=new Audio;var c={mp3:!!l.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!l.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!l.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!l.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),m4a:!!(l.canPlayType("audio/x-m4a;")||l.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!l.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")}}var u=function(e){var t=this;t._autoplay=e.autoplay||!1,t._buffer=e.buffer||!1,t._duration=e.duration||0,t._format=e.format||null,t._loop=e.loop||!1,t._loaded=!1,t._sprite=e.sprite||{},t._src=e.src||"",t._pos3d=e.pos3d||[0,0,-.5],t._volume=e.volume||1,t._urls=e.urls||[],t._rate=e.rate||1,t._onload=[e.onload||function(){}],t._onloaderror=[e.onloaderror||function(){}],t._onend=[e.onend||function(){}],t._onpause=[e.onpause||function(){}],t._onplay=[e.onplay||function(){}],t._onendTimer=[],t._webAudio=n&&!t._buffer,t._audioNode=[],t._webAudio&&t._setupAudioNode(),s._howls.push(t),t.load()};if(u.prototype={load:function(){var t=this,n=null;if(i)return t.on("loaderror"),void 0;for(var r=0;r<t._urls.length;r++){var a,o;if(t._format)a=t._format;else{if(o=t._urls[r].toLowerCase().split("?")[0],a=o.match(/.+\.([^?]+)(\?|$)/),a=a&&a.length>=2?a:o.match(/data\:audio\/([^?]+);/),!a)return t.on("loaderror"),void 0;a=a[1]}if(c[a]){n=t._urls[r];break}}if(!n)return t.on("loaderror"),void 0;if(t._src=n,t._webAudio)d(t,n);else{var l=new Audio;t._audioNode.push(l),l.src=n,l._pos=0,l.preload="auto",l.volume=s._muted?0:t._volume*s.volume(),e[n]=t;var u=function(){t._duration=l.duration,0===Object.getOwnPropertyNames(t._sprite).length&&(t._sprite={_default:[0,1e3*t._duration]}),t._loaded||(t._loaded=!0,t.on("load")),t._autoplay&&t.play(),l.removeEventListener("canplaythrough",u,!1)};l.addEventListener("canplaythrough",u,!1),l.load()}return t},urls:function(e){var t=this;return e?(t.stop(),t._urls="string"==typeof e?[e]:e,t._loaded=!1,t.load(),t):t._urls},play:function(e,n){var i=this;return"function"==typeof e&&(n=e),e&&"function"!=typeof e||(e="_default"),i._loaded?i._sprite[e]?(i._inactiveNode(function(r){r._sprite=e;var a,o=r._pos>0?r._pos:i._sprite[e][0]/1e3,l=i._sprite[e][1]/1e3-r._pos,c=!(!i._loop&&!i._sprite[e][2]),u="string"==typeof n?n:Math.round(Date.now()*Math.random())+"";if(function(){var t={id:u,sprite:e,loop:c};a=setTimeout(function(){!i._webAudio&&c&&i.stop(t.id,t.timer).play(e,t.id),i._webAudio&&!c&&(i._nodeById(t.id).paused=!0,i._nodeById(t.id)._pos=0),i._webAudio||c||i.stop(t.id,t.timer),i.on("end",u)},1e3*l),i._onendTimer.push(a),t.timer=i._onendTimer[i._onendTimer.length-1]}(),i._webAudio){var d=i._sprite[e][0]/1e3,h=i._sprite[e][1]/1e3;r.id=u,r.paused=!1,f(i,[c,d,h],u),i._playStart=t.currentTime,r.gain.value=i._volume,"undefined"==typeof r.bufferSource.start?r.bufferSource.noteGrainOn(0,o,l):r.bufferSource.start(0,o,l)}else{if(4!==r.readyState)return i._clearEndTimer(a),function(){var t=i,a=e,o=n,s=r,l=function(){t.play(a,o),s.removeEventListener("canplaythrough",l,!1)};s.addEventListener("canplaythrough",l,!1)}(),i;r.id=u,r.currentTime=o,r.muted=s._muted,r.volume=i._volume*s.volume(),setTimeout(function(){r.play()},0)}return i.on("play"),"function"==typeof n&&n(u),i}),i):("function"==typeof n&&n(),i):(i.on("load",function(){i.play(e,n)}),i)},pause:function(e,t){var n=this;if(!n._loaded)return n.on("play",function(){n.pause(e)}),n;n._clearEndTimer(t||0);var i=e?n._nodeById(e):n._activeNode();if(i)if(i._pos=n.pos(null,e),n._webAudio){if(!i.bufferSource)return n;i.paused=!0,"undefined"==typeof i.bufferSource.stop?i.bufferSource.noteOff(0):i.bufferSource.stop(0)}else i.pause();return n.on("pause"),n},stop:function(e,t){var n=this;if(!n._loaded)return n.on("play",function(){n.stop(e)}),n;n._clearEndTimer(t||0);var i=e?n._nodeById(e):n._activeNode();if(i)if(i._pos=0,n._webAudio){if(!i.bufferSource)return n;i.paused=!0,"undefined"==typeof i.bufferSource.stop?i.bufferSource.noteOff(0):i.bufferSource.stop(0)}else i.pause(),i.currentTime=0;return n},mute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.mute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=0:n.volume=0),t},unmute:function(e){var t=this;if(!t._loaded)return t.on("play",function(){t.unmute(e)}),t;var n=e?t._nodeById(e):t._activeNode();return n&&(t._webAudio?n.gain.value=t._volume:n.volume=t._volume),t},volume:function(e,t){var n=this;if(e=parseFloat(e),e>=0&&1>=e){if(n._volume=e,!n._loaded)return n.on("play",function(){n.volume(e,t)}),n;var i=t?n._nodeById(t):n._activeNode();return i&&(n._webAudio?i.gain.value=e:i.volume=e*s.volume()),n}return n._volume},loop:function(e){var t=this;return"boolean"==typeof e?(t._loop=e,t):t._loop},sprite:function(e){var t=this;return"object"==typeof e?(t._sprite=e,t):t._sprite},pos:function(e,n){var i=this;if(!i._loaded)return i.on("load",function(){i.pos(e)}),"number"==typeof e?i:i._pos||0;e=parseFloat(e);var r=n?i._nodeById(n):i._activeNode();if(r)return i._webAudio?e>=0?(r._pos=e,i.pause(n).play(r._sprite,n),i):r._pos+(t.currentTime-i._playStart):e>=0?(r.currentTime=e,i):r.currentTime;if(e>=0)return i;for(var a=0;a<i._audioNode.length;a++)if(i._audioNode[a].paused&&4===i._audioNode[a].readyState)return i._webAudio?i._audioNode[a]._pos:i._audioNode[a].currentTime},pos3d:function(e,t,n,i){var r=this;if(t="undefined"!=typeof t&&t?t:0,n="undefined"!=typeof n&&n?n:-.5,!r._loaded)return r.on("play",function(){r.pos3d(e,t,n,i)}),r;if(!(e>=0||0>e))return r._pos3d;if(r._webAudio){var a=i?r._nodeById(i):r._activeNode();a&&(r._pos3d=[e,t,n],a.panner.setPosition(e,t,n))}return r},fade:function(e,t,n,i,r){var a=this,o=Math.abs(e-t),s=e>t?"down":"up",l=o/.01,c=n/l;if(!a._loaded)return a.on("load",function(){a.fade(e,t,n,i,r)}),a;a.volume(e,r);for(var u=1;l>=u;u++)!function(){var e=a._volume+("up"===s?.01:-.01)*u,n=Math.round(1e3*e)/1e3,o=t;setTimeout(function(){a.volume(n,r),n===o&&i&&i()},c*u)}()},fadeIn:function(e,t,n){return this.volume(0).play().fade(0,e,t,n)},fadeOut:function(e,t,n,i){var r=this;return r.fade(r._volume,e,t,function(){n&&n(),r.pause(i),r.on("end")},i)},_nodeById:function(e){for(var t=this,n=t._audioNode[0],i=0;i<t._audioNode.length;i++)if(t._audioNode[i].id===e){n=t._audioNode[i];break}return n},_activeNode:function(){for(var e=this,t=null,n=0;n<e._audioNode.length;n++)if(!e._audioNode[n].paused){t=e._audioNode[n];break}return e._drainPool(),t},_inactiveNode:function(e){for(var t=this,n=null,i=0;i<t._audioNode.length;i++)if(t._audioNode[i].paused&&4===t._audioNode[i].readyState){e(t._audioNode[i]),n=!0;break}if(t._drainPool(),!n){var r;t._webAudio?(r=t._setupAudioNode(),e(r)):(t.load(),r=t._audioNode[t._audioNode.length-1],r.addEventListener("loadedmetadata",function(){e(r)}))}},_drainPool:function(){var e,t=this,n=0;for(e=0;e<t._audioNode.length;e++)t._audioNode[e].paused&&n++;for(e=t._audioNode.length-1;e>=0&&!(5>=n);e--)t._audioNode[e].paused&&(t._webAudio&&t._audioNode[e].disconnect(0),n--,t._audioNode.splice(e,1))},_clearEndTimer:function(e){var t=this,n=t._onendTimer.indexOf(e);n=n>=0?n:0,t._onendTimer[n]&&(clearTimeout(t._onendTimer[n]),t._onendTimer.splice(n,1))},_setupAudioNode:function(){var e=this,n=e._audioNode,i=e._audioNode.length;return n[i]="undefined"==typeof t.createGain?t.createGainNode():t.createGain(),n[i].gain.value=e._volume,n[i].paused=!0,n[i]._pos=0,n[i].readyState=4,n[i].connect(a),n[i].panner=t.createPanner(),n[i].panner.setPosition(e._pos3d[0],e._pos3d[1],e._pos3d[2]),n[i].panner.connect(n[i]),n[i]},on:function(e,t){var n=this,i=n["_on"+e];if("function"==typeof t)i.push(t);else for(var r=0;r<i.length;r++)t?i[r].call(n,t):i[r].call(n);return n},off:function(e,t){for(var n=this,i=n["_on"+e],r=t.toString(),a=0;a<i.length;a++)if(r===i[a].toString()){i.splice(a,1);break}return n},unload:function(){for(var t=this,n=t._audioNode,i=0;i<t._audioNode.length;i++)t.stop(n[i].id),t._webAudio?n[i].disconnect(0):n[i].src="";var r=s._howls.indexOf(t);r&&s._howls.splice(r,1),delete e[t._src],t=null}},n)var d=function(n,i){if(i in e)n._duration=e[i].duration,h(n);else{var r=new XMLHttpRequest;r.open("GET",i,!0),r.responseType="arraybuffer",r.onload=function(){t.decodeAudioData(r.response,function(t){t&&(e[i]=t,h(n,t))})},r.onerror=function(){n._webAudio&&(n._buffer=!0,n._webAudio=!1,n._audioNode=[],delete n._gainNode,n.load())};try{r.send()}catch(a){r.onerror()}}},h=function(e,t){e._duration=t?t.duration:e._duration,0===Object.getOwnPropertyNames(e._sprite).length&&(e._sprite={_default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e.on("load")),e._autoplay&&e.play()},f=function(n,i,r){var a=n._nodeById(r);a.bufferSource=t.createBufferSource(),a.bufferSource.buffer=e[n._src],a.bufferSource.connect(a.panner),a.bufferSource.loop=i[0],i[0]&&(a.bufferSource.loopStart=i[1],a.bufferSource.loopEnd=i[1]+i[2]),a.bufferSource.playbackRate.value=n._rate};"function"==typeof define&&define.amd&&define(function(){return{Howler:s,Howl:u}}),window.Howler=s,window.Howl=u}();

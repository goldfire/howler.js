/*!
 *  howler.js v2.0.0-beta
 *  howlerjs.com
 *
 *  (c) 2013-2015, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
(function(){"use strict";function e(){try{"undefined"!=typeof AudioContext?o=new AudioContext:"undefined"!=typeof webkitAudioContext?o=new webkitAudioContext:n=!1}catch(e){n=!1}if(!n)if("undefined"!=typeof Audio)try{new Audio}catch(e){r=!0}else r=!0}var o=null,n=!0,r=!1;if(e(),n){var t=o.createGain===void 0?o.createGainNode():o.createGain();t.gain.value=1,t.connect(o.destination)}var d=function(){this.init()};d.prototype={init:function(){var e=this||u;return e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e.iOSAutoEnable=!0,e.noAudio=r,e.usingWebAudio=n,e.ctx=o,r||e._setupCodecs(),e},volume:function(e){var o=this||u;if(e=parseFloat(e),e!==void 0&&e>=0&&1>=e){o._volume=e,n&&(t.gain.value=e);for(var r=0;o._howls.length>r;r++)if(!o._howls[r]._webAudio)for(var d=o._howls[r]._getSoundIds(),a=0;d.length>a;a++){var i=o._howls[r]._soundById(d[a]);i&&i._node&&(i._node.volume=i._volume*e)}return o}return o._volume},mute:function(e){var o=this||u;o._muted=e,n&&(t.gain.value=e?0:o._volume);for(var r=0;o._howls.length>r;r++)if(!o._howls[r]._webAudio)for(var d=o._howls[r]._getSoundIds(),a=0;d.length>a;a++){var i=o._howls[r]._soundById(d[a]);i&&i._node&&(i._node.muted=e?!0:i._muted)}return o},codecs:function(e){return(this||u)._codecs[e]},_setupCodecs:function(){var e=this||u,o=new Audio,n=o.canPlayType("audio/mpeg;").replace(/^no$/,"");return e._codecs={mp3:!(!n&&!o.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!n,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!o.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")},e},_enableiOSAudio:function(){var e=this||u;if(!o||!e._iOSEnabled&&/iPhone|iPad|iPod/i.test(navigator.userAgent)){e._iOSEnabled=!1;var n=function(){var r=o.createBuffer(1,1,22050),t=o.createBufferSource();t.buffer=r,t.connect(o.destination),t.start===void 0?t.noteOn(0):t.start(0),setTimeout(function(){(t.playbackState===t.PLAYING_STATE||t.playbackState===t.FINISHED_STATE)&&(e._iOSEnabled=!0,e.iOSAutoEnable=!1,window.removeEventListener("touchstart",n,!1))},0)};return window.addEventListener("touchstart",n,!1),e}}};var u=new d,a=function(e){var o=this;return e.src&&0!==e.src.length?(o.init(e),void 0):(console.error("An array of source files must be passed with any new Howl."),void 0)};a.prototype={init:function(e){var r=this;return r._autoplay=e.autoplay||!1,r._ext=e.ext||null,r._html5=e.html5||!1,r._muted=e.mute||!1,r._loop=e.loop||!1,r._pool=e.pool||5,r._preload="boolean"==typeof e.preload?e.preload:!0,r._rate=e.rate||1,r._sprite=e.sprite||{},r._src="string"!=typeof e.src?e.src:[e.src],r._volume=void 0!==e.volume?e.volume:1,r._duration=0,r._loaded=!1,r._sounds=[],r._endTimers={},r._onend=e.onend?[{fn:e.onend}]:[],r._onfaded=e.onfaded?[{fn:e.onfaded}]:[],r._onload=e.onload?[{fn:e.onload}]:[],r._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],r._onpause=e.onpause?[{fn:e.onpause}]:[],r._onplay=e.onplay?[{fn:e.onplay}]:[],r._webAudio=n&&!r._html5,o!==void 0&&o&&u.iOSAutoEnable&&u._enableiOSAudio(),u._howls.push(r),r._preload&&r.load(),r},load:function(){var e=this,o=null;if(r)return e._emit("loaderror"),void 0;"string"==typeof e._src&&(e._src=[e._src]);for(var n=0;e._src.length>n;n++){var t,d;if(e._ext&&e._ext[n]?t=e._ext[n]:(d=e._src[n],t=/^data:audio\/([^;,]+);/i.exec(d),t||(t=/\.([^.]+)$/.exec(d.split("?",1)[0])),t&&(t=t[1].toLowerCase())),u.codecs(t)){o=e._src[n];break}}return o?(e._src=o,new i(e),e._webAudio&&s(e),e):(e._emit("loaderror"),void 0)},play:function(e){var n=this,r=arguments,t=null;if("number"==typeof e)t=e,e=null;else if(e===void 0){e="__default";for(var d=0,a=0;n._sounds.length>a;a++)n._sounds[a]._paused&&!n._sounds[a]._ended&&(d++,t=n._sounds[a]._id);1===d?e=null:t=null}var i=t?n._soundById(t):n._inactiveSound();if(!i)return null;if(t&&!e&&(e=i._sprite||"__default"),!n._loaded&&!n._sprite[e])return n.once("load",function(){n.play(n._soundById(i._id)?i._id:void 0)}),i._id;if(t&&!i._paused)return i._id;var _=i._seek>0?i._seek:n._sprite[e][0]/1e3,s=(n._sprite[e][0]+n._sprite[e][1])/1e3-_,l=function(){var r=!(!i._loop&&!n._sprite[e][2]);n._emit("end",i._id),!n._webAudio&&r&&n.stop(i._id).play(i._id),n._webAudio&&r&&(n._emit("play",i._id),i._seek=i._start||0,i._playStart=o.currentTime,n._endTimers[i._id]=setTimeout(l,1e3*(i._stop-i._start)/Math.abs(n._rate))),n._webAudio&&!r&&(i._paused=!0,i._ended=!0,i._seek=i._start||0,n._clearTimer(i._id),i._node.bufferSource=null),n._webAudio||r||n.stop(i._id)};n._endTimers[i._id]=setTimeout(l,1e3*s/Math.abs(n._rate)),i._paused=!1,i._ended=!1,i._sprite=e,i._seek=_,i._start=n._sprite[e][0]/1e3,i._stop=(n._sprite[e][0]+n._sprite[e][1])/1e3,i._loop=!(!i._loop&&!n._sprite[e][2]);var f=i._node;if(n._webAudio){var c=function(){n._refreshBuffer(i);var e=i._muted||n._muted?0:i._volume*u.volume();f.gain.setValueAtTime(e,o.currentTime),i._playStart=o.currentTime,f.bufferSource.start===void 0?i._loop?f.bufferSource.noteGrainOn(0,_,86400):f.bufferSource.noteGrainOn(0,_,s):i._loop?f.bufferSource.start(0,_,86400):f.bufferSource.start(0,_,s),n._endTimers[i._id]||(n._endTimers[i._id]=setTimeout(l,1e3*s/Math.abs(n._rate))),r[1]||setTimeout(function(){n._emit("play",i._id)},0)};n._loaded?c():(n.once("load",c),n._clearTimer(i._id))}else{var p=function(){f.currentTime=_,f.muted=i._muted||n._muted||u._muted||f.muted,f.volume=i._volume*u.volume(),f.playbackRate=n._rate,setTimeout(function(){f.play(),r[1]||n._emit("play",i._id)},0)};if(4===f.readyState||!f.readyState&&navigator.isCocoonJS)p();else{var v=function(){n._endTimers[i._id]=setTimeout(l,1e3*s/Math.abs(n._rate)),p(),f.removeEventListener("canplaythrough",v,!1)};f.addEventListener("canplaythrough",v,!1),n._clearTimer(i._id)}}return i._id},pause:function(e){var o=this;if(!o._loaded)return o.once("play",function(){o.pause(e)}),o;for(var n=o._getSoundIds(e),r=0;n.length>r;r++){o._clearTimer(n[r]);var t=o._soundById(n[r]);if(t&&!t._paused){if(t._seek=o.seek(n[r]),t._paused=!0,o._webAudio){if(!t._node.bufferSource)return o;t._node.bufferSource.stop===void 0?t._node.bufferSource.noteOff(0):t._node.bufferSource.stop(0),t._node.bufferSource=null}else isNaN(t._node.duration)||t._node.pause();arguments[1]||o._emit("pause",t._id)}}return o},stop:function(e){var o=this;if(!o._loaded)return o._sounds[0]._sprite!==void 0&&o.once("play",function(){o.stop(e)}),o;for(var n=o._getSoundIds(e),r=0;n.length>r;r++){o._clearTimer(n[r]);var t=o._soundById(n[r]);if(t&&!t._paused)if(t._seek=t._start||0,t._paused=!0,t._ended=!0,o._webAudio&&t._node){if(!t._node.bufferSource)return o;t._node.bufferSource.stop===void 0?t._node.bufferSource.noteOff(0):t._node.bufferSource.stop(0),t._node.bufferSource=null}else t._node&&!isNaN(t._node.duration)&&(t._node.pause(),t._node.currentTime=t._start||0)}return o},mute:function(e,n){var r=this;if(!r._loaded)return r.once("play",function(){r.mute(e,n)}),r;if(n===void 0){if("boolean"!=typeof e)return r._muted;r._muted=e}for(var t=r._getSoundIds(n),d=0;t.length>d;d++){var a=r._soundById(t[d]);a&&(a._muted=e,r._webAudio&&a._node?a._node.gain.setValueAtTime(e?0:a._volume*u.volume(),o.currentTime):a._node&&(a._node.muted=u._muted?!0:e))}return r},volume:function(){var e,n,r=this,t=arguments;if(0===t.length)return r._volume;if(1===t.length){var d=r._getSoundIds(),a=d.indexOf(t[0]);a>=0?n=parseInt(t[0],10):e=parseFloat(t[0])}else 2===t.length&&(e=parseFloat(t[0]),n=parseInt(t[1],10));var i;if(!(e!==void 0&&e>=0&&1>=e))return i=n?r._soundById(n):r._sounds[0],i?i._volume:0;if(!r._loaded)return r.once("play",function(){r.volume.apply(r,t)}),r;n===void 0&&(r._volume=e),n=r._getSoundIds(n);for(var _=0;n.length>_;_++)i=r._soundById(n[_]),i&&(i._volume=e,r._webAudio&&i._node?i._node.gain.setValueAtTime(e*u.volume(),o.currentTime):i._node&&(i._node.volume=e*u.volume()));return r},fade:function(e,n,r,t){var d=this;if(!d._loaded)return d.once("play",function(){d.fade(e,n,r,t)}),d;d.volume(e,t);for(var u=d._getSoundIds(t),a=0;u.length>a;a++){var i=d._soundById(u[a]);if(i)if(d._webAudio){var _=o.currentTime,s=_+r/1e3;i._volume=e,i._node.gain.setValueAtTime(e,_),i._node.gain.linearRampToValueAtTime(n,s),setTimeout(function(e,r){setTimeout(function(){r._volume=n,d._emit("faded",e)},s-o.currentTime>0?Math.ceil(1e3*(s-o.currentTime)):0)}.bind(d,u[a],i),r)}else{var l=Math.abs(e-n),f=e>n?"out":"in",c=l/.01,p=r/c;(function(){var o=e,r=setInterval(function(e){o+="in"===f?.01:-.01,o=Math.max(0,o),o=Math.min(1,o),o=Math.round(100*o)/100,d.volume(o,e),o===n&&(clearInterval(r),d._emit("faded",e))}.bind(d,u[a]),p)})()}}return d},loop:function(){var e,o,n,r=this,t=arguments;if(0===t.length)return r._loop;if(1===t.length){if("boolean"!=typeof t[0])return n=r._soundById(parseInt(t[0],10)),n?n._loop:!1;e=t[0],r._loop=e}else 2===t.length&&(e=t[0],o=parseInt(t[1],10));for(var d=r._getSoundIds(o),u=0;d.length>u;u++)n=r._soundById(d[u]),n&&(n._loop=e,r._webAudio&&n._node&&(n._node.bufferSource.loop=e));return r},seek:function(){var e,n,r=this,t=arguments;if(0===t.length)n=r._sounds[0]._id;else if(1===t.length){var d=r._getSoundIds(),u=d.indexOf(t[0]);u>=0?n=parseInt(t[0],10):(n=r._sounds[0]._id,e=parseFloat(t[0]))}else 2===t.length&&(e=parseFloat(t[0]),n=parseInt(t[1],10));if(n===void 0)return r;if(!r._loaded)return r.once("load",function(){r.seek.apply(r,t)}),r;var a=r._soundById(n);if(a){if(!(e>=0))return e=r._webAudio?r.playing(n)?a._seek+(o.currentTime-a._playStart):a._paused?a._seek:0:a._node.currentTime;var i=r.playing(n);i&&r.pause(n,!0),a._seek=e,r._clearTimer(n),i&&r.play(n,!0)}return r},playing:function(e){var o=this,n=o._soundById(e)||o._sounds[0];return n?!n._paused:!1},duration:function(){return this._duration},unload:function(){for(var e=this,o=e._sounds,n=0;o.length>n;n++){o[n]._paused||(e.stop(o[n]._id),e._emit("end",o[n]._id)),e._webAudio||(o[n]._node.src="",o[n]._node.removeEventListener("error",o[n]._errorFn,!1),o[n]._node.removeEventListener("canplaythrough",o[n]._loadFn,!1)),delete o[n]._node,e._clearTimer(o[n]._id);var r=u._howls.indexOf(e);r>=0&&u._howls.splice(r,1)}return _&&delete _[e._src],e=null,null},on:function(e,o,n){var r=this,t=r["_on"+e];return"function"==typeof o&&t.push({id:n,fn:o}),r},off:function(e,o,n){var r=this,t=r["_on"+e];if(o){for(var d=0;t.length>d;d++)if(o===t[d].fn&&n===t[d].id){t.splice(d,1);break}}else t=[];return r},once:function(e,o,n){var r=this,t=function(){o.apply(r,arguments),r.off(e,t,n)};return r.on(e,t,n),r},_emit:function(e,o,n){for(var r=this,t=r["_on"+e],d=0;t.length>d;d++)t[d].id&&t[d].id!==o||setTimeout(function(e){e.call(this,o,n)}.bind(r,t[d].fn),0);return r},_clearTimer:function(e){var o=this;return o._endTimers[e]&&(clearTimeout(o._endTimers[e]),delete o._endTimers[e]),o},_soundById:function(e){for(var o=this,n=0;o._sounds.length>n;n++)if(e===o._sounds[n]._id)return o._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var o=0;e._sounds.length>o;o++)if(e._sounds[o]._ended)return e._sounds[o].reset();return new i(e)},_drain:function(){var e=this,o=e._pool,n=0,r=0;if(!(o>e._sounds.length)){for(r=0;e._sounds.length>r;r++)e._sounds[r]._ended&&n++;for(r=e._sounds.length-1;r>=0;r--){if(o>=n)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),n--)}}},_getSoundIds:function(e){var o=this;if(e===void 0){for(var n=[],r=0;o._sounds.length>r;r++)n.push(o._sounds[r]._id);return n}return[e]},_refreshBuffer:function(e){var n=this;return e._node.bufferSource=o.createBufferSource(),e._node.bufferSource.buffer=_[n._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop),e._node.bufferSource.playbackRate.value=n._rate,n}};var i=function(e){this._parent=e,this.init()};if(i.prototype={init:function(){var e=this,o=e._parent;return e._muted=o._muted,e._loop=o._loop,e._volume=o._volume,e._muted=o._muted,e._seek=0,e._paused=!0,e._ended=!0,e._id=Math.round(Date.now()*Math.random()),o._sounds.push(e),e.create(),e},create:function(){var e=this,n=e._parent,r=u._muted||e._muted||e._parent._muted?0:e._volume*u.volume();return n._webAudio?(e._node=o.createGain===void 0?o.createGainNode():o.createGain(),e._node.gain.setValueAtTime(r,o.currentTime),e._node.paused=!0,e._node.connect(t)):(e._node=new Audio,e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener("canplaythrough",e._loadFn,!1),e._node.src=n._src,e._node.preload="auto",e._node.volume=r,e._node.load()),e},reset:function(){var e=this,o=e._parent;return e._muted=o._muted,e._loop=o._loop,e._volume=o._volume,e._muted=o._muted,e._seek=0,e._paused=!0,e._ended=!0,e._sprite=null,e._id=Math.round(Date.now()*Math.random()),e},_errorListener:function(){var e=this;e._node.error&&4===e._node.error.code&&(u.noAudio=!0),e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorListener,!1)},_loadListener:function(){var e=this,o=e._parent;o._duration=Math.ceil(10*e._node.duration)/10,0===Object.keys(o._sprite).length&&(o._sprite={__default:[0,1e3*o._duration]}),o._loaded||(o._loaded=!0,o._emit("load")),o._autoplay&&o.play(),e._node.removeEventListener("canplaythrough",e._loadFn,!1)}},n)var _={},s=function(e){var o=e._src;if(_[o])return e._duration=_[o].duration,c(e),void 0;if(/^data:[^;]+;base64,/.test(o)){window.atob=window.atob||function(e){for(var o,n,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=(e+"").replace(/=+$/,""),d=0,u=0,a="";n=t.charAt(u++);~n&&(o=d%4?64*o+n:n,d++%4)?a+=String.fromCharCode(255&o>>(6&-2*d)):0)n=r.indexOf(n);return a};for(var n=atob(o.split(",")[1]),r=new Uint8Array(n.length),t=0;n.length>t;++t)r[t]=n.charCodeAt(t);f(r.buffer,e)}else{var d=new XMLHttpRequest;d.open("GET",o,!0),d.responseType="arraybuffer",d.onload=function(){f(d.response,e)},d.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete _[o],e.load())},l(d)}},l=function(e){try{e.send()}catch(o){e.onerror()}},f=function(e,n){o.decodeAudioData(e,function(e){e&&(_[n._src]=e,c(n,e))},function(){n._emit("loaderror")})},c=function(e,o){o&&!e._duration&&(e._duration=o.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),e._loaded||(e._loaded=!0,e._emit("load")),e._autoplay&&e.play()};"function"==typeof define&&define.amd&&define("howler",function(){return{Howler:u,Howl:a}}),"undefined"!=typeof exports&&(exports.Howler=u,exports.Howl=a),"undefined"!=typeof window&&(window.HowlerGlobal=d,window.Howler=u,window.Howl=a,window.Sound=i)})();
/*! howler.js v2.0.0-beta | (c) 2013-2014, James Simpson of GoldFire Studios | MIT License | howlerjs.com */
!function(){"use strict";function p(){try{if(typeof AudioContext!=="undefined"){e=new AudioContext}else if(typeof webkitAudioContext!=="undefined"){e=new webkitAudioContext}else{t=false}}catch(r){t=false}if(!t){if(typeof Audio!=="undefined"){try{new Audio}catch(r){n=true}}else{n=true}}}var e=null;var t=true;var n=false;p();if(t){var r=typeof e.createGain==="undefined"?e.createGainNode():e.createGain();r.gain.value=1;r.connect(e.destination)}var i=function(){this.init()};i.prototype={init:function(){var r=this||s;r._codecs={};r._howls=[];r._muted=false;r._volume=1;r.iOSAutoEnable=true;r.noAudio=n;r.usingWebAudio=t;r.ctx=e;if(!n){r._setupCodecs()}return r},volume:function(e){var n=this||s;e=parseFloat(e);if(typeof e!=="undefined"&&e>=0&&e<=1){n._volume=e;if(t){r.gain.value=e}for(var i=0;i<n._howls.length;i++){if(!n._howls[i]._webAudio){var o=n._howls[i]._getSoundIds();for(var u=0;u<o.length;u++){var a=n._howls[i]._soundById(o[u]);if(a){a._node.volume=a._volume*e}}}}return n}return n._volume},mute:function(e){var n=this||s;n._muted=e;if(t){r.gain.value=e?0:n._volume}for(var i=0;i<n._howls.length;i++){if(!n._howls[i]._webAudio){var o=n._howls[i]._getSoundIds();for(var u=0;u<o.length;u++){var a=n._howls[i]._soundById(o[u]);if(a){a._node.muted=e}}}}return n},codecs:function(e){return(this||s)._codecs[e]},_setupCodecs:function(){var e=this||s;var t=new Audio;e._codecs={mp3:!!t.canPlayType("audio/mpeg;").replace(/^no$/,""),opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!t.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,""),webm:!!t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")};return e},_enableiOSAudio:function(){var t=this||s;if(e&&(t._iOSEnabled||!/iPhone|iPad|iPod/i.test(navigator.userAgent))){return}t._iOSEnabled=false;var n=function(){var r=e.createBuffer(1,1,22050);var i=e.createBufferSource();i.buffer=r;i.connect(e.destination);if(typeof i.start==="undefined"){i.noteOn(0)}else{i.start(0)}setTimeout(function(){if(i.playbackState===i.PLAYING_STATE||i.playbackState===i.FINISHED_STATE){t._iOSEnabled=true;t.iOSAutoEnable=false;window.removeEventListener("touchstart",n,false)}},0)};window.addEventListener("touchstart",n,false);return t}};var s=new i;var o=function(e){var t=this;if(!e.src){console.error("An array of source files must be passed with any new Howl.");return}t.init(e)};o.prototype={init:function(n){var r=this;r._autoplay=n.autoplay||false;r._ext=n.ext||null;r._html5=n.html5||false;r._muted=n.mute||false;r._loop=n.loop||false;r._pool=n.pool||5;r._preload=typeof n.preload==="boolean"?n.preload:true;r._rate=n.rate||1;r._sprite=n.sprite||{};r._src=typeof n.src!=="string"?n.src:[n.src];r._buffersize=n.buffersize;r._bufferfile=n.bufferfile;r._volume=n.volume!==undefined?n.volume:1;r._duration=0;r._loaded=false;r._sounds=[];r._endTimers={};r._onend=n.onend?[{fn:n.onend}]:[];r._onfaded=n.onfaded?[{fn:n.onfaded}]:[];r._onload=n.onload?[{fn:n.onload}]:[];r._onloaderror=n.onloaderror?[{fn:n.onloaderror}]:[];r._onpause=n.onpause?[{fn:n.onpause}]:[];r._onplay=n.onplay?[{fn:n.onplay}]:[];r._webAudio=t&&!r._html5;if(typeof e!=="undefined"&&e&&s.iOSAutoEnable){s._enableiOSAudio()}s._howls.push(r);if(r._preload){r.load()}return r},load:function(){var e=this;var t=null;if(n){e._emit("loaderror");return}for(var r=0;r<e._src.length;r++){var i,o;if(e._ext&&e._ext[r]){i=e._ext[r]}else{o=e._src[r];i=/^data:audio\/([^;,]+);/i.exec(o);if(!i){i=/\.([^.]+)$/.exec(o.split("?",1)[0])}if(i){i=i[1].toLowerCase()}}if(s.codecs(i)){t=e._src[r];break}}if(!t){e._emit("loaderror");return}e._src=t;new u(e);if(e._webAudio)f(e);return e},play:function(t){var n=this;var r=null;if(typeof t==="number"){r=t;t=null}else if(typeof t==="undefined"){t="__default";var i=0;for(var o=0;o<n._sounds.length;o++){if(n._sounds[o]._paused&&!n._sounds[o]._ended){i++;r=n._sounds[o]._id}}if(i===1){t=null}else{r=null}}var u=r?n._soundById(r):n._inactiveSound();if(r&&!t)t=u._sprite||"__default";if(!u)return null;if(!n._loaded&&!n._sprite[t]){n.once("load",function(){n.play(u._id)});return u._id}if(r&&!u._paused)return u._id;var a=u._seek>0?u._seek:n._sprite[t][0]/1e3;if(n._is_preload_buffer)n._preload_buffer_id=u._id;n._last_sound_was_preload_buffer=!!(n._preload_buffer_id&&typeof n.use_preload_buffer!="undefined"&&!n._is_preload_buffer);if(!n._last_sound_was_preload_buffer){var f=a}else{var f=n.seek(undefined,n._preload_buffer_id);var l=n._soundById(n._preload_buffer_id);u._ended=false;n.stop(n._preload_buffer_id,true);l._ended=true;clearTimeout(n._endTimers[n._preload_buffer_id]);n._drain({force_drain:true});delete n._preload_buffer_id}var c=(n._sprite[t][0]+n._sprite[t][1])/1e3-a;var h=n._is_preload_buffer?false:!!(u._loop||n._sprite[t][2]);var p=function(){n._emit("end",u._id);if(!n._webAudio&&h)n.stop(u._id).play(u._id);if(n._webAudio&&h){n._emit("play",u._id);u._seek=u._start||0;u._playStart=e.currentTime;n._endTimers[u._id]=setTimeout(p,(u._stop-u._start)*1e3/Math.abs(n._rate))}if(n._webAudio&&!h){u._paused=true;u._ended=true;u._seek=u._start||0;n._clearTimer(u._id);u._node.bufferSource=null}if(!n._webAudio&&!h)n.stop(u._id)};n._endTimers[u._id]=setTimeout(p,c*1e3/Math.abs(n._rate));u._paused=false;u._ended=false;u._sprite=t;u._seek=f;u._start=n._sprite[t][0]/1e3;u._stop=(n._sprite[t][0]+n._sprite[t][1])/1e3;u._loop=h;var d=u._node;if(n._webAudio){var v=function(){n._refreshBuffer(u);var t=u._muted||n._muted?0:u._volume*s.volume();d.gain.setValueAtTime(t,e.currentTime);u._playStart=e.currentTime;if(typeof d.bufferSource.start==="undefined"){d.bufferSource.noteGrainOn(0,f,c)}else{d.bufferSource.start(0,f,c)}if(!n._endTimers[u._id]){n._endTimers[u._id]=setTimeout(p,c*1e3/Math.abs(n._rate))}if(!n._last_sound_was_preload_buffer)setTimeout(function(){n._emit("play",u._id)},0)};if(n._loaded){v()}else{if(!n._last_sound_was_preload_buffer)n.once("load",v);n._clearTimer(u._id)}}else{var m=function(){d.currentTime=f;d.muted=u._muted||n._muted||s._muted||d.muted;d.volume=u._volume*s.volume();d.playbackRate=n._rate;setTimeout(function(){d.play();n._emit("play",u._id)},0)};if(d.readyState===4||!d.readyState&&navigator.isCocoonJS){m()}else{var g=function(){n._endTimers[u._id]=setTimeout(p,c*1e3/Math.abs(n._rate));m();d.removeEventListener("canplaythrough",g,false)};d.addEventListener("canplaythrough",g,false);n._clearTimer(u._id)}}return u._id},pause:function(e){var t=this;if(!t._loaded){t.once("play",function(){t.pause(e)});return t}var n=t._getSoundIds(e);for(var r=0;r<n.length;r++){t._clearTimer(n[r]);var i=t._soundById(n[r]);if(i&&!i._paused){i._seek=t.seek(undefined,n[r]);i._paused=true;if(t._webAudio){if(!i._node.bufferSource)return t;if(typeof i._node.bufferSource.stop==="undefined"){i._node.bufferSource.noteOff(0)}else{i._node.bufferSource.stop(0)}i._node.bufferSource=null}else if(!isNaN(i._node.duration)){i._node.pause()}if(!arguments[1])t._emit("pause",i._id)}}return t},stop:function(e,t){var n=this;if(!t&&(n._is_preload_buffer||!n._loaded)){n.once("play",function(){n.stop(e)});return n}var r=n._getSoundIds(e);for(var i=0;i<r.length;i++){n._clearTimer(r[i]);var s=n._soundById(r[i]);if(s&&!s._paused){s._seek=s._start||0;s._paused=true;s._ended=true;if(n._webAudio){if(!s._node.bufferSource){return n}if(typeof s._node.bufferSource.stop==="undefined"){s._node.bufferSource.noteOff(0)}else{s._node.bufferSource.stop(0)}s._node.bufferSource=null}else if(!isNaN(s._node.duration)){s._node.pause();s._node.currentTime=s._start||0}}}return n},mute:function(t,n){var r=this;if(!r._loaded){r.once("play",function(){r.mute(t,n)});return r}if(typeof n==="undefined"){if(typeof t==="boolean"){r._muted=t}else{return r._muted}}var i=r._getSoundIds(n);for(var o=0;o<i.length;o++){var u=r._soundById(i[o]);if(u){u._muted=t;if(r._webAudio){u._node.gain.setValueAtTime(t?0:u._volume*s.volume(),e.currentTime)}else{u._node.muted=t}}}return r},volume:function(){var t=this;var n=arguments;var r,i;if(n.length===0){return t._volume}else if(n.length===1){var o=t._getSoundIds();var u=o.indexOf(n[0]);if(u>=0){i=parseInt(n[0],10)}else{r=parseFloat(n[0])}}else if(n.length===2){r=parseFloat(n[0]);i=parseInt(n[1],10)}var a;if(typeof r!=="undefined"&&r>=0&&r<=1){if(!t._loaded){t.once("play",function(){t.volume.apply(t,n)});return t}if(typeof i==="undefined"){t._volume=r}i=t._getSoundIds(i);for(var f=0;f<i.length;f++){a=t._soundById(i[f]);if(a){a._volume=r;if(t._webAudio){a._node.gain.setValueAtTime(r*s.volume(),e.currentTime)}else{a._node.volume=r*s.volume()}}}}else{a=i?t._soundById(i):t._sounds[0];return a?a._volume:0}return t},fade:function(t,n,r,i){var s=this;if(!s._loaded){s.once("play",function(){s.fade(t,n,r,i)});return s}s.volume(t,i);var o=s._getSoundIds(i);for(var u=0;u<o.length;u++){var a=s._soundById(o[u]);if(a){if(s._webAudio){var f=e.currentTime;var l=f+r/1e3;a._volume=t;a._node.gain.setValueAtTime(t,f);a._node.gain.linearRampToValueAtTime(n,l);setTimeout(function(t,r){setTimeout(function(){r._volume=n;s._emit("faded",t)},l-e.currentTime>0?Math.ceil((l-e.currentTime)*1e3):0)}.bind(s,o[u],a),r)}else{var c=Math.abs(t-n);var h=t>n?"out":"in";var p=c/.01;var d=r/p;(function(){var e=t;var r=setInterval(function(t){e+=h==="in"?.01:-.01;e=Math.max(0,e);e=Math.min(1,e);e=Math.round(e*100)/100;s.volume(e,t);if(e===n){clearInterval(r);s._emit("faded",t)}}.bind(s,o[u]),d)})()}}}return s},loop:function(){var e=this;var t=arguments;var n,r,i;if(t.length===0){return e._loop}else if(t.length===1){if(typeof t[0]==="boolean"){n=t[0]}else{i=e._soundById(parseInt(t[0],10));return i?i._loop:false}}else if(t.length===2){n=t[0];r=parseInt(t[1],10)}var s=e._getSoundIds(r);for(var o=0;o<s.length;o++){i=e._soundById(s[o]);if(i){i._loop=n}}return e},seek:function(t,n){var r=this;if(typeof t=="undefined"){if(!r._loaded){r.once("load",function(){r.seek.apply(r,t,n)});return 0}var n=typeof n!="undefined"?n:r._sounds[0]._id;var i=r._soundById(n);return r._webAudio?i._seek+(e.currentTime-i._playStart):i._node.currentTime}n=typeof n!="undefined"?n:r._sounds[0]._id;var i=r._soundById(n);if(!i)return r;var s=r.playing(n);if(s)r.pause(n,true);i._seek=t;var o=i._sprite||"__default";r._sprite[o][0]=t;r._clearTimer(n);if(s)r.play(n);return r},playing:function(e){var t=this;var n=t._soundById(e)||t._sounds[0];return n?!n._paused:false},duration:function(){return this._duration},unload:function(){var e=this;var t=e._sounds;for(var n=0;n<t.length;n++){if(!t[n]._paused){e.stop(t[n]._id);e._emit("end",t[n]._id)}if(!e._webAudio){t[n]._node.src="";t[n]._node.removeEventListener("error",t[n]._errorFn,false);t[n]._node.removeEventListener("canplaythrough",t[n]._loadFn,false)}delete t[n]._node;e._clearTimer(t[n]._id);var r=s._howls.indexOf(e);if(r>=0){s._howls.splice(r,1)}}if(a){delete a[e._src]}e=null;return null},on:function(e,t,n){var r=this;var i=r["_on"+e];if(typeof t==="function"){i.push({id:n,fn:t})}return r},off:function(e,t,n){var r=this;var i=r["_on"+e];if(t){for(var s=0;s<i.length;s++){if(t===i[s].fn&&n===i[s].id){i.splice(s,1);break}}}else{i=[]}return r},once:function(e,t,n){var r=this;var i=function(){t.apply(r,arguments);r.off(e,i,n)};r.on(e,i,n);return r},_emit:function(e,t,n){var r=this;var i=r["_on"+e];for(var s=0;s<i.length;s++){if(!i[s].id||i[s].id===t){setTimeout(function(e){e.call(this,t,n)}.bind(r,i[s].fn),0)}}return r},_clearTimer:function(e){var t=this;if(t._endTimers[e]){clearTimeout(t._endTimers[e]);delete t._endTimers[e]}return t},_soundById:function(e){var t=this;for(var n=0;n<t._sounds.length;n++){if(e===t._sounds[n]._id){return t._sounds[n]}}return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++){if(e._sounds[t]._ended){return e._sounds[t].reset()}}return new u(e)},_drain:function(e){var e=e||{};var t=this;var n=t._pool;var r=0;if(!e.force_drain&&t._sounds.length<n)return;for(var i=0;i<t._sounds.length;i++){if(t._sounds[i]._ended)r++}for(var i=t._sounds.length-1;i>=0;i--){if(!e.force_drain&&r<=n)return;if(!t._sounds[i]._ended)continue;if(t._webAudio&&t._sounds[i]._node)t._sounds[i]._node.disconnect(0);t._sounds.splice(i,1);r--}},_getSoundIds:function(e){var t=this;if(typeof e==="undefined"){var n=[];for(var r=0;r<t._sounds.length;r++){n.push(t._sounds[r]._id)}return n}else{return[e]}},_refreshBuffer:function(t){var n=this;t._node.bufferSource=e.createBufferSource();t._node.bufferSource.buffer=a[n._src];if(t._panner){t._node.bufferSource.connect(t._panner)}else{t._node.bufferSource.connect(t._node)}t._node.bufferSource.loop=t._loop;if(t._loop){t._node.bufferSource.loopStart=t._start||0;t._node.bufferSource.loopEnd=t._stop}t._node.bufferSource.playbackRate.value=n._rate;return n}};var u=function(e){this._parent=e;this.init()};u.prototype={init:function(){var e=this;var t=e._parent;e._muted=t._muted;e._loop=t._loop;e._volume=t._volume;e._muted=t._muted;e._seek=0;e._paused=true;e._ended=true;e._id=Math.round(Date.now()*Math.random());t._sounds.push(e);e.create();return e},create:function(){var t=this;var n=t._parent;var i=s._muted||t._muted||t._parent._muted?0:t._volume*s.volume();if(n._webAudio){t._node=typeof e.createGain==="undefined"?e.createGainNode():e.createGain();t._node.gain.setValueAtTime(i,e.currentTime);t._node.paused=true;t._node.connect(r)}else{t._node=new Audio;t._errorFn=t._errorListener.bind(t);t._node.addEventListener("error",t._errorFn,false);t._loadFn=t._loadListener.bind(t);t._node.addEventListener("canplaythrough",t._loadFn,false);t._node.src=n._src;t._node.preload="auto";t._node.volume=i;t._node.load()}return t},reset:function(){var e=this;var t=e._parent;e._muted=t._muted;e._loop=t._loop;e._volume=t._volume;e._muted=t._muted;e._seek=0;e._paused=true;e._ended=true;e._sprite=null;e._id=Math.round(Date.now()*Math.random());return e},_errorListener:function(){var e=this;if(e._node.error&&e._node.error.code===4){s.noAudio=true}parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0);e._node.removeEventListener("error",e._errorListener,false)},_loadListener:function(){var e=this;var t=e._parent;t._duration=Math.ceil(e._node.duration*10)/10;if(Object.keys(t._sprite).length===0){t._sprite={__default:[0,t._duration*1e3]}}if(!t._loaded){t._loaded=true;t._emit("load")}if(t._autoplay){t.play()}e._node.removeEventListener("canplaythrough",e._loadListener,false)}};if(t){var a={};var f=function(e){var t=e._src;if(a[t]){e._duration=a[t].duration;h(e);return}if(/^data:[^;]+;base64,/.test(t)){var n=atob(t.split(",")[1]);var r=new Uint8Array(n.length);for(var i=0;i<n.length;++i){r[i]=n.charCodeAt(i)}c(r.buffer,e)}else{if(typeof e._buffersize!="undefined"||typeof e._bufferfile!="undefined"){e.use_preload_buffer=true;var s=new XMLHttpRequest;s.open("GET",typeof e._bufferfile!="undefined"?e._bufferfile:t,true);if(typeof e._buffersize!="undefined"){s.setRequestHeader("Range","bytes=0-"+(e._buffersize-1));s.setRequestHeader("Content-Length",e._buffersize)}s.responseType="arraybuffer";s.onload=function(){c(s.response,e,true)};s.onerror=function(){};l(s)}var o=new XMLHttpRequest;o.open("GET",t,true);o.responseType="arraybuffer";o.onload=function(){c(o.response,e)};o.onerror=function(){if(e._webAudio){e._buffer=true;e._webAudio=false;e._sounds=[];delete a[t];e.load()}};l(o)}};var l=function(e){try{e.send()}catch(t){e.onerror()}};var c=function(t,n,r){e.decodeAudioData(t,function(e){if(e){a[n._src]=e;h(n,e,!!r)}},function(){n._emit("loaderror")})};var h=function(e,t,n){if(t)e._duration=t.duration;e._loop=false;var r=!!e._is_preload_buffer&&!n;if(r||Object.keys(e._sprite).length===0){e._sprite={__default:[0,e._duration*1e3]}}e._is_preload_buffer=n;if(!e._loaded){e._loaded=true;e._emit("load")}if(e._autoplay)e.play()}}if(typeof define==="function"&&define.amd){define("howler",function(){return{Howler:s,Howl:o}})}if(typeof exports!=="undefined"){exports.Howler=s;exports.Howl=o}if(typeof window!=="undefined"){window.HowlerGlobal=i;window.Howler=s;window.Howl=o;window.Sound=u}}();
